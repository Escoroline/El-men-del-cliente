<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>COCINA | S√°ndwich Clandestino</title>
    <style>
        body { background: #000; color: #fff; font-family: 'Courier New', monospace; padding: 20px; }
        .ticket { border: 2px solid #d4af37; padding: 15px; border-radius: 10px; margin-bottom: 20px; background: #111; position: relative; }
        .direccion { background: #d4af37; color: black; padding: 5px 10px; font-weight: bold; margin-bottom: 10px; text-transform: uppercase; }
        .btn-listo { background: #d4af37; color: black; border: none; padding: 10px; font-weight: bold; border-radius: 5px; cursor: pointer; width: 100%; margin-top: 10px; }
        hr { border: 0; border-top: 1px dotted #444; margin: 10px 0; }
    </style>
</head>
<body>
    <h1 style="color:#d4af37; text-align:center;">COMANDAS CLANDESTINAS</h1>
    <div id="comandas-container">CARGANDO PEDIDOS...</div>

    <script>
        const urlDB = "https://sandwich-clandestinos-default-rtdb.firebaseio.com/pedidos.json";

        async function cargarPedidos() {
            try {
                const response = await fetch(urlDB);
                const data = await response.json();
                const container = document.getElementById('comandas-container');
                container.innerHTML = "";

                if (!data) {
                    container.innerHTML = "<h2 style='text-align:center; color:#555;'>ESPERANDO PEDIDOS...</h2>";
                    return;
                }

                Object.keys(data).reverse().forEach(id => {
                    const pedido = data[id];
                    let itemsHtml = pedido.items.map(i => `‚Ä¢ ${i.n} <br><small style="color:#ff4444;">&nbsp;&nbsp;Sin: ${i.sin}</small><br>`).join('');

                    container.innerHTML += `
                        <div class="ticket">
                            <div class="direccion">üìç ${pedido.direccion}</div>
                            <p><strong>TEL:</strong> ${pedido.telefono} | <strong>HORA:</strong> ${pedido.hora}</p>
                            <hr>
                            ${itemsHtml}
                            <hr>
                            <p><strong>TOTAL: $${pedido.total}</strong></p>
                            <p>Paga con: $${pedido.pagaCon} | Cambio: $${pedido.cambio}</p>
                            <button class="btn-listo" onclick="completarPedido('${id}')">‚úì MARCAR COMO ENTREGADO</button>
                        </div>
                    `;
                });
            } catch (e) { console.error("Error cargando pedidos", e); }
        }

        async function completarPedido(id) {
            if (confirm("¬øDeseas eliminar esta comanda?")) {
                await fetch(`https://sandwich-clandestinos-default-rtdb.firebaseio.com/pedidos/${id}.json`, { method: 'DELETE' });
                cargarPedidos();
            }
        }

        setInterval(cargarPedidos, 5000);
        cargarPedidos();
    </script>
</body>
</html>
