<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Cocina | Clandestino</title>
    <style>
        body { background: #000; color: #fff; font-family: 'Courier New', monospace; padding: 20px; }
        #panel { display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 25px; }
        .ticket { border: 2px solid #d4af37; background: #111; padding: 20px; border-radius: 15px; }
        .dir-label { background: #d4af37; color: #000; padding: 10px; font-weight: bold; margin-bottom: 15px; }
        .item { border-bottom: 1px dashed #444; padding: 10px 0; }
        .alerta-sin { color: #ff4444; font-weight: bold; background: rgba(255,0,0,0.1); padding: 5px; display: block; margin-top: 5px; }
        .pago-box { border: 1px solid #00ff00; color: #00ff00; padding: 10px; margin-top: 15px; font-weight: bold; }
        .btn { background: #d4af37; color: #000; border: none; width: 100%; padding: 15px; font-weight: bold; cursor: pointer; border-radius: 8px; margin-top: 10px; }
    </style>
</head>
<body>
    <h1 style="text-align:center; color:#d4af37;">üìü PEDIDOS CLANDESTINOS</h1>
    <div id="panel">CARGANDO...</div>

    <script>
        const url = "https://sandwich-clandestinos-default-rtdb.firebaseio.com/pedidos.json";
        async function cargar() {
            const res = await fetch(url);
            const data = await res.json();
            const p = document.getElementById('panel');
            p.innerHTML = "";
            if(!data) return p.innerHTML = "SIN PEDIDOS";
            Object.keys(data).forEach(id => {
                const ped = data[id];
                p.innerHTML += `
                    <div class="ticket">
                        <div class="dir-label">üìç ${ped.dir}</div>
                        <small>${ped.hora}</small>
                        ${ped.items.map(i => `<div class="item"><strong>${i.n}</strong><span class="alerta-sin">SIN: ${i.sin}</span></div>`).join('')}
                        <div class="pago-box">TOTAL: $${ped.total}<br>PAGA: $${ped.paga}<br>CAMBIO: $${ped.cambio}</div>
                        <button class="btn" onclick="listo('${id}')">ENTREGADO</button>
                    </div>`;
            });
        }
        async function listo(id) {
            if(confirm("¬øPedido entregado?")) {
                await fetch(`https://sandwich-clandestinos-default-rtdb.firebaseio.com/pedidos/${id}.json`, { method: 'DELETE' });
                cargar();
            }
        }
        setInterval(cargar, 5000); cargar();
    </script>
</body>
</html>
